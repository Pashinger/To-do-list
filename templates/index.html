{% extends 'base.html' %}

{% block content %}

<div class="modal fade modal-sm" id="TaskModal" tabindex="-1" aria-labelledby="TaskModal" aria-hidden="true">
  <div class="modal-dialog border border-1 rounded-3 border-secondary" style="max-width: 202px;">
    <div class="modal-content">
        <form method="POST">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
        <input type="hidden" id="task-id-input" name="task_id" value="">
          <div class="modal-body">
            <button class="btn border-0 focus-ring focus-ring-secondary rounded-4"
                    name="action"
                    value="move_up"
                    data-bs-toggle="tooltip"
                    data-bs-trigger="hover"
                    data-bs-title="Move up">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="bi bi-caret-up-fill" viewBox="0 0 16 16">
                <path d="m7.247 4.86-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"/>
              </svg>
            </button>
            <button class="btn border-0 focus-ring focus-ring-secondary rounded-4"
                    name="action"
                    value="move_down"
                    data-bs-toggle="tooltip"
                    data-bs-trigger="hover"
                    data-bs-title="Move down">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="bi bi-caret-down-fill" viewBox="0 0 16 16">
                <path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/>
              </svg>
            </button>
            <button class="btn border-0 focus-ring focus-ring-secondary rounded-4"
                    name="action"
                    value="edit"
                    data-bs-toggle="tooltip"
                    data-bs-trigger="hover"
                    data-bs-title="Edit">
              <svg xmlns="http://www.w3.org/2000/svg" width="0.8em" height="0.8em" class="bi bi-pencil-fill" viewBox="0 0 16 16">
                <path d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.5.5 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11z"/>
              </svg>
            </button>
            <button class="btn text-dark border-0 focus-ring focus-ring-secondary rounded-4"
                    name="action"
                    value="delete"
                    data-bs-toggle="tooltip"
                    data-bs-trigger="hover"
                    data-bs-title="Delete task">
                <strong>X</strong>
            </button>
          </div>
      </form>
    </div>
  </div>
</div>


<div class="modal fade" id="EditOptions" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog border border-dark rounded-3" style="max-width: 800px;">
    <div class="modal-content">
      <form method="POST">
      <input type="hidden" name="form_id" value="edit_list">
      {{ edit_list.hidden_tag() }}
      <div class="modal-header">
        <h1 class="modal-title text-center w-100 fs-5" id="exampleModalLabel">Choose style</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
          <div class="form-floating d-flex justify-content-center">
              <div class="row text-center">
                <div class="col">
                  <img src="static/images/blank.jpg" alt="plain style" class="img-thumbnail border-0" style="max-width: 100px; max-height: 120px;">
                  <div class="form-check">
                    {% if style == 'plain' %}
                    <input class="form-check-input" type="radio" name="styleOption" value="plain" checked>
                    <label class="form-check-label">plain</label>
                    {% else %}
                    <input class="form-check-input" type="radio" name="styleOption" value="plain">
                    <label class="form-check-label">plain</label>
                    {% endif %}
                  </div>
                </div>
                <div class="col">
                  <img src="static/images/retro.png" alt="retro style" class="img-thumbnail border-0" style="max-width: 100px; max-height: 120px;">
                  <div class="form-check">
                    {% if style == 'retro' %}
                    <input class="form-check-input" type="radio" name="styleOption" value="retro" checked>
                    <label class="form-check-label">retro</label>
                    {% else %}
                    <input class="form-check-input" type="radio" name="styleOption" value="retro">
                    <label class="form-check-label">retro</label>
                    {% endif %}
                  </div>
                </div>
                <div class="col">
                  <img src="static/images/notebook.jpg" alt="notebook" class="img-thumbnail border-0" style="max-width: 100px; max-height: 120px;">
                  <div class="form-check">
                    {% if style == 'notebook' %}
                    <input class="form-check-input" type="radio" name="styleOption" value="notebook" checked>
                    <label class="form-check-label">notebook</label>
                    {% else %}
                    <input class="form-check-input" type="radio" name="styleOption" value="notebook">
                    <label class="form-check-label">notebook</label>
                    {% endif %}
                  </div>
                </div>
              </div>
          </div>
          <hr>
          <div class="form-floating d-flex justify-content-center">
              <div class="row text-center">
                <div class="col">
                  <div class="form-check">
                    {% if font == 'times' %}
                    <input class="form-check-input" type="radio" name="fontOption" value="times" checked>
                    <label class="form-check-label font-times">Times New Roman</label>
                    {% else %}
                    <input class="form-check-input" type="radio" name="fontOption" value="times">
                    <label class="form-check-label font-times">Times New Roman</label>
                    {% endif %}
                  </div>
                </div>
                <div class="col">
                  <div class="form-check">
                    {% if font == 'cour' %}
                    <input class="form-check-input" type="radio" name="fontOption" value="cour" checked>
                    <label class="form-check-label font-courier">Courier New</label>
                    {% else %}
                    <input class="form-check-input" type="radio" name="fontOption" value="cour">
                    <label class="form-check-label font-courier">Courier New</label>
                    {% endif %}
                  </div>
                </div>
                <div class="col">
                  <div class="form-check">
                    {% if font == 'segoesc' %}
                    <input class="form-check-input" type="radio" name="fontOption" value="segoesc" checked>
                    <label class="form-check-label font-segoe">Segoe Script</label>
                    {% else %}
                    <input class="form-check-input" type="radio" name="fontOption" value="segoesc">
                    <label class="form-check-label font-segoe">Segoe Script</label>
                    {% endif %}
                  </div>
                </div>
              </div>
          </div>
      </div>
      <div class="modal-footer">
          {{ edit_list.options_submit(class="btn btn-dark") }}
        <a href="{{ url_for('home') }}" class="btn btn-dark" data-bs-dismiss="modal">Close</a>
      </div>
      </form>
    </div>
  </div>
</div>


<div class="d-flex flex-column flex-row p-5 gap-4 align-items-center justify-content-center col-md-12">
  <div class="list-group col-8 p-5 m-5 bg-body-tertiary border border-dark border-2">
    <div class="d-flex bg-body-secondary p-3 border border-bottom-0 rounded-top align-items-center position-relative">
        <h2 class="ps-4 w-100">{{ list_name }}</h2>
        <form method="POST">
            <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
            <button class="btn border-0 focus-ring focus-ring-dark rounded-4" name="action" value="save" data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-title="Save your list" style="--bs-focus-ring-x: 2px; --bs-focus-ring-y: 2px;">
              <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentCol or" class="bi bi-floppy2-fill" viewBox="0 0 16 16">
                <path d="M12 2h-2v3h2z"/>
                <path d="M1.5 0A1.5 1.5 0 0 0 0 1.5v13A1.5 1.5 0 0 0 1.5 16h13a1.5 1.5 0 0 0 1.5-1.5V2.914a1.5 1.5 0 0 0-.44-1.06L14.147.439A1.5 1.5 0 0 0 13.086 0zM4 6a1 1 0 0 1-1-1V1h10v4a1 1 0 0 1-1 1zM3 9h10a1 1 0 0 1 1 1v5H2v-5a1 1 0 0 1 1-1"/>
              </svg>
            </button>
        </form>
        <form method="POST">
            <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
            <button class="btn border-0 focus-ring focus-ring-dark rounded-4" type="submit" name="action" value="new" data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-title="Make a new list" style="--bs-focus-ring-x: 2px; --bs-focus-ring-y: 2px;">
              <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-arrow-counterclockwise" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"/>
                <path d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"/>
              </svg>
            </button>
        </form>
        <form method="POST" data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-title="Edit options">
            <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
            <button class="btn border-0 focus-ring focus-ring-dark rounded-4" type="button" data-bs-toggle="modal" data-bs-target="#EditOptions" style="--bs-focus-ring-x: 2px; --bs-focus-ring-y: 2px;">
              <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-pencil" viewBox="0 0 16 16">
                <path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325"/>
              </svg>
            </button>
        </form>
    </div>
      {% for task in tasks_list %}
      <div class="list-group-item d-flex gap-3">
        <form method="POST">
          <input type="hidden" name="form_id" value="checkbox_form">
          {{ checkbox_form.hidden_tag() }}
          <input type="hidden" name="checkbox_hidden" value="{{ loop.index0 }}">
          {% if task[2] %}
            {{ checkbox_form.checkbox(class="form-check-input flex-shrink-0",
                                      type="checkbox",
                                      onchange="this.form.submit();",
                                      style="font-size: 1.375em;",
                                      checked="checked"
                                      )
            }}
          {% else %}
            {{ checkbox_form.checkbox(class="form-check-input flex-shrink-0",
                                      type="checkbox",
                                      onchange="this.form.submit();",
                                      style="font-size: 1.375em;"
                                      )
            }}
          {% endif %}
        </form>
          <div class="form-checked-content flex-grow-1 text-break text-{{ task[1] }}"
               id="{{ loop.index0 }}"
               data-bs-toggle="modal"
               data-bs-target="#TaskModal"
               data-task-id="{{ loop.index0 }}">
            <strong class="{{ 'text-decoration-line-through' if task[2] else '' }}">{{ task[0] }}</strong>
          </div>
      </div>
      {% endfor %}

    {% if edited_task_data %}
    <form method="POST" class="list-group-item d-flex gap-3 bg-body-secondary">
      <input type="hidden" name="form_id" value="edit_form">
      {{ edit_form.hidden_tag() }}
      <div class="dropdown align-middle" data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-title="Choose text color" style="padding-top: 12px;">
          <button class="btn p-0 border-0" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            <img src="{{ url_for('static', filename='images/colorbox.jpg') }}" style="width: 1.375em; height: 1.375em;" alt="colorbox" loading="lazy">
          </button>
          <ul class="dropdown-menu bg-body-secondary border-0" style="min-width: auto; padding: 0; margin: 0;">
            {% if edited_task_data[1] == 'success' %}
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-success" type="radio" name="taskColor" value="success" style="font-size: 1.375em; padding: 0; margin: 0;" checked></li>
            {% else %}
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-success" type="radio" name="taskColor" value="success" style="font-size: 1.375em; padding: 0; margin: 0;"></li>
            {% endif %}
            {% if edited_task_data[1] == 'warning' %}
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-warning" type="radio" name="taskColor" value="warning" style="font-size: 1.375em; padding: 0; margin: 0;" checked></li>
            {% else %}
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-warning" type="radio" name="taskColor" value="warning" style="font-size: 1.375em; padding: 0; margin: 0;"></li>
            {% endif %}
            {% if edited_task_data[1] == 'primary' %}
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-primary" type="radio" name="taskColor" value="primary" style="font-size: 1.375em; padding: 0; margin: 0;" checked></li>
            {% else %}
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-primary" type="radio" name="taskColor" value="primary" style="font-size: 1.375em; padding: 0; margin: 0;"></li>
            {% endif %}
            {% if edited_task_data[1] == 'danger' %}
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-danger" type="radio" name="taskColor" value="danger" style="font-size: 1.375em; padding: 0; margin: 0;" checked></li>
            {% else %}
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-danger" type="radio" name="taskColor" value="danger" style="font-size: 1.375em; padding: 0; margin: 0;"></li>
            {% endif %}
            {% if edited_task_data[1] == 'secondary' %}
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-secondary" type="radio" name="taskColor" value="secondary" style="font-size: 1.375em; padding: 0; margin: 0;" checked></li>
            {% else %}
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-secondary" type="radio" name="taskColor" value="secondary" style="font-size: 1.375em; padding: 0; margin: 0;"></li>
            {% endif %}
            {% if edited_task_data[1] == 'dark' %}
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-dark" type="radio" name="taskColor" value="dark" style="font-size: 1.375em; padding: 0; margin: 0;" checked></li>
            {% else %}
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-dark" type="radio" name="taskColor" value="dark" style="font-size: 1.375em; padding: 0; margin: 0;"></li>
            {% endif %}
          </ul>
      </div>
      <div class="d-flex w-100 align-items-center">
        <div class="form-floating me-3 w-100">
          {{ edit_form.edited_task(class="form-control", id="floatingInput", placeholder="edit_task", value=edited_task_data[0]) }}
          {{ edit_form.edited_task.label(class="form-label", for="floatingInput") }}
        </div>
        <div class="row gap-1 p-1">
          {{ edit_form.edit_submit(class="btn btn-dark", style="font-size: 0.75rem; padding: 0.20rem 0.5rem;") }}
          <a href="{{ url_for('home') }}" class="btn btn-dark" style="font-size: 0.75rem; padding: 0.20rem 0.5rem;">Cancel</a>
        </div>
      </div>
    </form>
    {% else %}
    <form method="POST" class="list-group-item d-flex gap-3 bg-body-secondary">
      <input type="hidden" name="form_id" value="add_form">
      {{ add_form.hidden_tag() }}
      <div class="dropdown align-middle" data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-title="Choose text color" style="padding-top: 12px;">
          <button class="btn p-0 border-0" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            <img src="{{ url_for('static', filename='images/colorbox.jpg') }}" style="width: 1.375em; height: 1.375em;" alt="colorbox" loading="lazy">
          </button>
          <ul class="dropdown-menu bg-body-secondary border-0" style="min-width: auto; padding: 0; margin: 0;">
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-success" type="radio" name="taskColor" value="success" style="font-size: 1.375em; padding: 0; margin: 0;"></li>
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-warning" type="radio" name="taskColor" value="warning" style="font-size: 1.375em; padding: 0; margin: 0;"></li>
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-primary" type="radio" name="taskColor" value="primary" style="font-size: 1.375em; padding: 0; margin: 0;"></li>
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-danger" type="radio" name="taskColor" value="danger" style="font-size: 1.375em; padding: 0; margin: 0;"></li>
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-secondary" type="radio" name="taskColor" value="secondary" style="font-size: 1.375em; padding: 0; margin: 0;"></li>
            <li><input class="form-check-input shadow-none flex-shrink-0 text-bg-dark" type="radio" name="taskColor" value="dark" style="font-size: 1.375em; padding: 0; margin: 0;"></li>
          </ul>
      </div>
      <div class="d-flex w-100 align-items-center">
        <div class="form-floating me-3 w-100">
          {{ add_form.new_task(class="form-control", id="floatingInput", placeholder="add_a_task") }}
          {{ add_form.new_task.label(class="form-label", for="floatingInput") }}
        </div>
          {{ add_form.new_task_submit(class="btn btn-dark") }}
      </div>
    </form>
    {% endif %}
  </div>
</div>

{% endblock %}